[env:nano100b]
platform = nordicnrf51
board = nano100b
framework = cmsis

; 编译器设置
build_flags = 
    -DNANO100B
    -DUSE_HAL_DRIVER
    -DHSE_VALUE=12000000
    -DOTA_ENABLE=1
    -DOTA_MAX_FIRMWARE_SIZE=0x38000
    -DOTA_CHUNK_SIZE=1024
    -Os
    -g3
    -Wall
    -Wextra
    -ffunction-sections
    -fdata-sections

; 链接器设置
build_unflags = -Os
board_build.ldscript = linker/nano100b_flash.ld

; 调试器设置
debug_tool = jlink
debug_interface = swd
debug_speed = 4000

; 上传设置
upload_protocol = jlink
upload_flags = 
    --target
    NANO100B
    --interface
    SWD
    --speed
    4000

; 串口监控
monitor_speed = 115200
monitor_port = /dev/cu.usbserial*
monitor_filters = 
    default
    time
    log2file

; 库依赖
lib_deps = 
    mbedtls

; 源码目录
src_dir = app
include_dir = app
build_dir = build

; 测试设置
[env:test]
platform = native
build_flags = 
    -DUNIT_TEST
    -std=c99
lib_deps = 
    unity
test_framework = unity
test_ignore = test_embedded 